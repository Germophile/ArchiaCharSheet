<!--
  To do:
  - Finish implementation of abilities:
  options (will probably have to make INDIVIDUAL hidden/shown options for each one *sigh*)
  edit/finish editing button for abilities (to get rid of the ugly dropdowns)
-->

Name: <input type="text" name="attr_character_name" title="@{character_name}"/> 
<button type="action" name="act_roll">ROLL</button>
<button type="action" name="act_edit">EDIT</button>
<br>

<div class="column left">
<h2>Attributes</h2>
<input type="hidden" value="" name="attr_attributeSelect" >
<input type="hidden" value="" name="attr_skillSelect" >
<input type="hidden" value="" name="attr_affinitySelect" >

<button class="d4 attrButton statButton brawnButton off" type="action" name="act_brawn/Die"></button>
Brawn <input type="number" class="editor hidden" name="attr_brawn" step="2" value="4" min="4" max="10" /><br>

  <button class="d4 attrButton statButton finesseButton off" type="action" name="act_finesse/Die"></button>
  Finesse <input type="number" class="editor hidden" name="attr_finesse" step="2" value="4" min="4" max="10" />
<br>

  <button class="d4 attrButton statButton knowledgeButton off" type="action" name="act_knowledge/Die"></button>
  Knowledge <input type="number" class="editor hidden" name="attr_knowledge" step="2" value="4" min="4" max="10" />
<br>
  <button class="d4 attrButton statButton wisdomButton off" type="action" name="act_wisdom/Die"></button>
  Wisdom <input type="number" class="editor hidden" name="attr_wisdom" step="2" value="4" min="4" max="10" />

  <h2>Skills</h2>

  <button class="d4 skillButton statButton athleticismButton off" type="action" name="act_athleticism/Die"></button>
  Athleticism <input type="number" class="editor hidden" name="attr_athleticism" step="2" value="4" min="4" max="12" />
<br>

<button class="d4 skillButton statButton deductionButton off" type="action" name="act_deduction/Die"></button>
  Deduction <input type="number" class="editor hidden" name="attr_deduction" step="2" value="4" min="4" max="12" />
<br>
  
<button class="d4 skillButton statButton empathyButton off" type="action" name="act_empathy/Die"></button>
  Empathy <input type="number" class="editor hidden" name="attr_empathy" step="2" value="4" min="4" max="12" />
<br>

<button class="d4 skillButton statButton focusButton off" type="action" name="act_focus/Die"></button>
  Focus <input type="number" class="editor hidden" name="attr_focus" step="2" value="4" min="4" max="12" />
<br>

<button class="d4 skillButton statButton perceptionButton off" type="action" name="act_perception/Die"></button>
  Perception <input type="number" class="editor hidden" name="attr_perception" step="2" value="4" min="4" max="12" />
<br>

<button class="d4 skillButton statButton performanceButton off" type="action" name="act_performance/Die"></button>
  Performance <input type="number" class="editor hidden" name="attr_performance" step="2" value="4" min="4" max="12" />
<br>

<button class="d4 skillButton statButton recognitionButton off" type="action" name="act_recognition/Die"></button>
  Recognition <input type="number" class="editor hidden" name="attr_recognition" step="2" value="4" min="4" max="12" />
<br>

<button class="d4 skillButton statButton skulduggeryButton off" type="action" name="act_skulduggery/Die"></button>
  Skulduggery <input type="number" class="editor hidden" name="attr_skulduggery" step="2" value="4" min="4" max="12" />
<br>

<button class="d4 skillButton statButton stealthButton off" type="action" name="act_stealth/Die"></button>
  Stealth <input type="number" class="editor hidden" name="attr_stealth" step="2" value="4" min="4" max="12" />
<br>
</div>

<div class ="column middle">

  <h2>Affinities</h2>

  <button class="d4 affinityButton statButton divineButton off" type="action" name="act_divine/Die"></button>
Divine <input type="number" class="editor hidden" name="attr_divine" step="2" value="4" min="4" max="12" />
<br>

<button class="d4 affinityButton statButton profaneButton off" type="action" name="act_profane/Die"></button>
Profane <input type="number" class="editor hidden" name="attr_profane" step="2" value="4" min="4" max="12" />
<br>

<button class="d4 affinityButton statButton arcaneButton off" type="action" name="act_arcane/Die"></button>
Arcane <input type="number" class="editor hidden" name="attr_arcane" step="2" value="4" min="4" max="12" />
<br>

<button class="d4 affinityButton statButton primevalButton off" type="action" name="act_primeval/Die"></button>
Primeval <input type="number" class="editor hidden" name="attr_primeval" step="2" value="4" min="4" max="12" />
<br>

<button class="d4 affinityButton statButton mundaneButton off" type="action" name="act_mundane/Die"></button>
Mundane <input type="number" class="editor hidden" name="attr_mundane" step="2" value="4" min="4" max="12" />
<br>

</div>

<div class ="column right">

<h2>Abilities</h2>

<fieldset class="repeating_abilities">
  
  <h3><span name="attr_ability"></span> <button class="editIcon" type="action" name="act_edit"></button></h3>
  Source: <span name="attr_abilitySource"></span><br>
  <span name="attr_abilityType"></span> (<span name="attr_abilitySubType"></span>)

  <input type="hidden" value=0 name="attr_abilityAPcost" />
  <input type="hidden" value=0 name="attr_abilitySPcost" />
  <input type="hidden" value="" name="attr_abilityType" class="type" />
  <input type="hidden" value="" name="attr_abilitySubType" />
  <input type="hidden" value="true" name="attr_editing" class="editing"/>
  <input type="hidden" value="divine" name="attr_source" class="source"/>

  <div class="editor">
    <input name="attr_ability" title="" type="text" value=""/>
    <!--repeating_abilities code below this will be modified by script-->
  <br>Source: <select name="attr_ability-source">
    <option value="None" selected="selected"></option>
    <option value="Divine">Divine</option>
    <option value="Profane">Profane</option>
    <option value="Arcane">Arcane</option>
    <option value="Primeval">Primeval</option>
    <option value="Mundane">Mundane</option>
  </select>
  <br>Ability Type: 
    <span class="Divine">
        <select name="attr_ability-type-divine" class="abilityType divine">
            <option value="None" selected="selected"></option>
            <option value="Attack">Attack</option>
            <option value="Augmentation">Augmentation</option>
            <option value="Communication">Communication</option>
            <option value="Divination">Divination</option>
            <option value="Rejuvenation">Rejuvenation</option>
            <option value="Scourge">Scourge</option>
        </select>
    </span>
    <span class="Profane">
        <select name="attr_ability-type-profane" class="abilityType profane">
            <option value="None" selected="selected"></option>
            <option value="Attack">Attack</option>
            <option value="Cataclysm">Cataclysm</option>
            <option value="Communication">Communication</option>
            <option value="Illusion">Illusion</option>
            <option value="Psionics">Psionics</option>
            <option value="Scourge">Scourge</option>
        </select>
    </span>
    <span class="Arcane">
        <select name="attr_ability-type-arcane" class="abilityType arcane">
            <option value="None" selected="selected"></option>
            <option value="Attack">Attack</option>
            <option value="Augmentation">Augmentation</option>
            <option value="Communication">Communication</option>
            <option value="Creation">Creation</option>
            <option value="Illusion">Illusion</option>
            <option value="Magisprudence">Magisprudence</option>
        </select>
    </span>
    <span class="Primeval">
        <select name="attr_ability-type-primeval" class="abilityType primeval">
            <option value="None" selected="selected"></option>
            <option value="Attack">Attack</option>
            <option value="Augmentation">Augmentation</option>
            <option value="Cataclysm">Cataclysm</option>
            <option value="Communication">Communication</option>
            <option value="Druidism">Druidism</option>
            <option value="Rejuvenation">Rejuvenation</option>
        </select>
    </span>
    <span class="Mundane">
        <select name="attr_ability-type-mundane" class="abilityType mundane">
            <option value="None" selected="selected"></option>
            <option value="Attack">Attack</option>
            <option value="Cataclysm">Cataclysm</option>
            <option value="Communication">Communication</option>
            <option value="Creation">Creation</option>
            <option value="Maneuvers">Maneuvers</option>
            <option value="Rejuvenation">Rejuvenation</option>
        </select>
    </span>

  <br>Ability Subtype: 
    <span class="Attack">
        <select name="attr_ability-subtype-attack" class ="abilitySubType attack">
            <option value="None" selected="selected"></option>
            <option value="Attack">Attack</option>
        </select>
    </span>
    <span class="Augmentation">
        <select name="attr_ability-subtype-augmentation" class ="abilitySubType augmentation">
            <option value="None" selected="selected"></option>
            <option value="Shield">Shield</option>
            <option value="Buff">Buff</option>
        </select>
    </span>
    <span class="Cataclysm">
        <select name="attr_ability-subtype-cataclysm" class ="abilitySubType cataclysm">
            <option value="None" selected="selected"></option>
            <option value="Destruction">Destruction</option>
            <option value="Suppression">Suppression</option>
        </select>
    </span>
    <span class="Communication">
        <select name="attr_ability-subtype-communication" class ="abilitySubType communication">
            <option value="None" selected="selected"></option>
            <option value="Sending">Sending</option>
            <option value="Comprehension">Comprehension</option>
        </select>
    </span>
    <span class="Creation">
        <select name="attr_ability-subtype-creation" class ="abilitySubType creation">
            <option value="None" selected="selected"></option>
            <option value="Fabricate">Fabricate</option>
            <option value="Imbue">Imbue</option>
        </select>
    </span>
    <span class="Divination">
        <select name="attr_ability-subtype-divination" class ="abilitySubType divination">
            <option value="None" selected="selected"></option>
            <option value="Augury">Augury</option>
            <option value="Scrying">Scrying</option>
        </select>
    </span>
    <span class="Druidism">
        <select name="attr_ability-subtype-druidism" class ="abilitySubType druidism">
            <option value="None" selected="selected"></option>
            <option value="Floromancy">Floromancy</option>
            <option value="Faunomancy">Faunomancy</option>
        </select>
    </span>
    <span class="Illusion">
        <select name="attr_ability-subtype-illusion" class ="abilitySubType illusion">
            <option value="None" selected="selected"></option>
            <option value="Personal">Personal</option>
            <option value="Projected">Projected</option>
        </select>
    </span>
    <span class="Magisprudence">
        <select name="attr_ability-subtype-magisprudence" class ="abilitySubType magisprudence">
            <option value="None" selected="selected"></option>
            <option value="Magic Sense">Magic Sense</option>
            <option value="Teleportation">Teleportation</option>
        </select>
    </span>
    <span class="Maneuvers">
        <select name="attr_ability-subtype-maneuvers" class ="abilitySubType maneuvers">
            <option value="None" selected="selected"></option>
            <option value="Exploits">Exploits</option>
            <option value="Stunts">Stunts</option>
        </select>
    </span>
    <span class="Psionics">
        <select name="attr_ability-subtype-psionics" class ="abilitySubType psionics">
            <option value="None" selected="selected"></option>
            <option value="Telepathy">Telepathy</option>
            <option value="Telekinesis">Telekinesis</option>
        </select>
    </span>
    <span class="Rejuvenation">
        <select name="attr_ability-subtype-rejuvenation" class ="abilitySubType rejuvenation">
            <option value="None" selected="selected"></option>
            <option value="HP">HP</option>
            <option value="Mild Conditions">Mild Conditions</option>
        </select>
    </span>
    <span class="Scourge">
        <select name="attr_ability-subtype-scourge" class ="abilitySubType scourge">
            <option value="None" selected="selected"></option>
            <option value="Against Skill Checks">Against Skill Checks</option>
            <option value="Status Condition">Status Condition</option>
        </select>
    </span>

    <!--repeating_abilities code above this will be modified by script-->
  </div>
  

  <textarea name="attr_ability_desc" class="edit"></textarea>

  

</fieldset>

</div>

  <rolltemplate class="sheet-rolltemplate-test">
    <div class="sheet-template-container">
        <h3>{{roll1}} {{name}}</h3>
    </div>
</rolltemplate>

<script type="text/worker">
  on('clicked:roll', function() {
      getAttrs(["attributeSelect","skillSelect","affinitySelect","Brawn","Finesse","Knowledge","Wisdom","skillSelect","Athleticism","Deduction","Empathy","Focus","Perception","Performance","Recognition","Skulduggery","Stealth","Divine","Profane","Arcane","Primeval","Mundane"], function(values) {
          var name = "";
          var rollstring = "";
          const stats = ["attribute","skill","affinity"];
  
          for(var x in stats) {
              if(values[stats[x]+"Select"].length > 1) {
                  skillDie = values[values[stats[x]+"Select"]];
                  if(name.length > 0) {
                      name += "/";
                      rollstring += "+";
                  }
                  name += values[stats[x]+"Select"];
                  rollstring += "1d" + values[values[stats[x]+"Select"]];
              }
          }
  
          startRoll("&{template:test} {{name="+name+"}} {{roll1=[[" + rollstring + "]]}}", (results) => {
              finishRoll(
                  results.rollId
              );
          });
      });
  
  });
  
  on('clicked:edit', function() {
      $20('.editor').toggleClass("hidden");
  });
  
  function changeAttr(attr) {
      getAttrs([attr], function(values) {
          const attrClass = '.' + attr.toLowerCase() + 'Button';
          const dieArray = ["d4","d6","d8","d10","d12"];
          for(var x in dieArray) $20(attrClass).removeClass(dieArray[x]);
          $20(attrClass).addClass("d" + values[attr]);
      });
  }
  
  function attrSelect(type, attr) {
      type = type + "Select";
      getAttrs([type], function(values) {
          if(values[type] == attr) setAttrs({[type]: ""});
          else setAttrs({[type]: attr});
      });
  }
  
  on('change:brawn', function() {changeAttr('Brawn')});
  on('change:finesse', function() {changeAttr('Finesse')});
  on('change:knowledge', function() {changeAttr('Knowledge')});
  on('change:wisdom', function() {changeAttr('Wisdom')});
  
  on('change:athleticism', function() {changeAttr('Athleticism')});
  on('change:deduction', function() {changeAttr('Deduction')});
  on('change:empathy', function() {changeAttr('Empathy')});
  on('change:focus', function() {changeAttr('Focus')});
  on('change:perception', function() {changeAttr('Perception')});
  on('change:performance', function() {changeAttr('Performance')});
  on('change:recognition', function() {changeAttr('Recognition')});
  on('change:skulduggery', function() {changeAttr('Skulduggery')});
  on('change:stealth', function() {changeAttr('Stealth')});
  
  on('change:divine', function() {changeAttr('Divine')});
  on('change:profane', function() {changeAttr('Profane')});
  on('change:arcane', function() {changeAttr('Arcane')});
  on('change:primeval', function() {changeAttr('Primeval')});
  on('change:mundane', function() {changeAttr('Mundane')});
  
  on('clicked:brawn/Die', function() {attrSelect("attribute","Brawn")});
  on('clicked:finesse/Die', function() {attrSelect("attribute","Finesse")});
  on('clicked:knowledge/Die', function() {attrSelect("attribute","Knowledge")});
  on('clicked:wisdom/Die', function() {attrSelect("attribute","Wisdom")});
  
  on('clicked:athleticism/Die', function() {attrSelect("skill","Athleticism")});
  on('clicked:deduction/Die', function() {attrSelect("skill","Deduction")});
  on('clicked:empathy/Die', function() {attrSelect("skill","Empathy")});
  on('clicked:focus/Die', function() {attrSelect("skill","Focus")});
  on('clicked:perception/Die', function() {attrSelect("skill","Perception")});
  on('clicked:performance/Die', function() {attrSelect("skill","Performance")});
  on('clicked:recognition/Die', function() {attrSelect("skill","Recognition")});
  on('clicked:skulduggery/Die', function() {attrSelect("skill","Skulduggery")});
  on('clicked:stealth/Die', function() {attrSelect("skill","Stealth")});
  
  on('clicked:divine/Die', function() {attrSelect("affinity","Divine")});
  on('clicked:profane/Die', function() {attrSelect("affinity","Profane")});
  on('clicked:arcane/Die', function() {attrSelect("affinity","Arcane")});
  on('clicked:primeval/Die', function() {attrSelect("affinity","Primeval")});
  on('clicked:mundane/Die', function() {attrSelect("affinity","Mundane")});
  
  on('change:attributeSelect', function() {
      getAttrs(["attributeSelect"], function(values) {
          $20('.attrButton').removeClass("on");
          $20('.attrButton').addClass("off");
          var cssRef = '.' + values.attributeSelect.toLowerCase() + 'Button';
          $20(cssRef).addClass("on");
          $20(cssRef).removeClass("off");
      });
  });
  
  on('change:skillSelect', function() {
      getAttrs(["skillSelect"], function(values) {
          $20('.skillButton').removeClass("on");
          $20('.skillButton').addClass("off");
          var cssRef = '.' + values.skillSelect.toLowerCase() + 'Button';
          $20(cssRef).addClass("on");
          $20(cssRef).removeClass("off");
      });
  });
  
  on('change:affinitySelect', function() {
      getAttrs(["affinitySelect"], function(values) {
          $20('.affinityButton').removeClass("on");
          $20('.affinityButton').addClass("off");
          var cssRef = '.' + values.affinitySelect.toLowerCase() + 'Button';
          $20(cssRef).addClass("on");
          $20(cssRef).removeClass("off");
      });
  });
          
  on('sheet:opened', function(){
      getAttrs(["attributeSelect","skillSelect","affinitySelect","Brawn","Finesse","Knowledge","Wisdom","Athleticism","Deduction","Empathy","Focus","Perception","Performance","Recognition","Skulduggery","Stealth","Divine","Profane","Arcane","Primeval","Mundane"], function(values) {
          const dieArray = ["d4","d6","d8","d10","d12"];
          const statArray = ["Brawn","Finesse","Knowledge","Wisdom","Athleticism","Deduction","Empathy","Focus","Perception","Performance","Recognition","Skulduggery","Stealth","Divine","Profane","Arcane","Primeval","Mundane"];
          $20('.attrButton').removeClass("on");
          $20('.attrButton').addClass("off");
          for(var x in dieArray) $20('.attrButton').removeClass(dieArray[x]);
          var cssRef = '.' + values.attributeSelect.toLowerCase() + 'Button';
          $20(cssRef).addClass("on");
          $20(cssRef).removeClass("off");
          cssRef = '.' + values.skillSelect.toLowerCase() + 'Button';
          $20(cssRef).addClass("on");
          $20(cssRef).removeClass("off");
          cssRef = '.' + values.affinitySelect.toLowerCase() + 'Button';
          $20(cssRef).addClass("on");
          $20(cssRef).removeClass("off");
          for(var x in statArray) $20('.'+statArray[x].toLowerCase()+'Button').addClass("d" + values[statArray[x]]);
      });
  });

  <!--Repeating_abilities script:-->

  on("change:repeating_abilities:ability-source", function() {
    getAttrs(["repeating_abilities_ability-source","repeating_abilities_ability-type","repeating_abilities_ability-subtype"], function(values) {
        var abilityTypes = {
            "Divine":["Attack","Augmentation","Communication","Divination","Rejuvenation","Scourge"],
            "Profane":["Attack","Cataclysm","Communication","Illusion","Psionics","Scourge"],
            "Arcane":["Attack","Augmentation","Communication","Creation","Illusion","Magisprudence"],
            "Primeval":["Attack","Augmentation","Cataclysm","Communication","Druidism","Rejuvenation"],
            "Mundane":["Attack","Cataclysm","Communication","Creation","Maneuvers","Rejuvenation"]
        };
        if(!abilityTypes[values.repeating_abilities_ability-source].includes(values.repeating_abilities_ability-type)) {
            setAttrs({"repeating_abilities_ability-type":"Attack","repeating_abilities_ability-subtype":"Attack"});mundane
        }
        else setAttrs({"repeating_abilities_ability-type-" + values.repeating_abilities_ability-source.toLowerCase():values.repeating_abilities_ability-type,"repeating_abilities_ability-subtype-" + values.repeating_abilities_ability-type.toLowerCase():values.repeating_abilities_ability-subtype});
    })
  });

  on("change:repeating_abilities:ability-type", function() {
    getAttrs(["repeating_abilities_ability-type"], function(values) {
        var abilitySubTypes = {
            "Attack":"Attack",
            "Augmentation":"Shield",
            "Cataclysm":"Destruction",
            "Communication":"Sending",
            "Creation":"Fabricate",
            "Divination":"Augury",
            "Druidism":"Floromancy",
            "Illusion":"Personal",
            "Magisprudence":"Magic Sense",
            "Maneuvers":"Exploits",
            "Psionics":"Telepathy",
            "Rejuvenation":"HP",
            "Scourge":"Against Skill Checks"
        };
        setAttrs({"repeating_abilities_ability-subtype":abilitySubTypes[values.repeating_abilities_ability-type]});
    })
  });
  on("change:repeating_abilities:ability-type-divine", function() {
    getAttrs(["repeating_abilities_ability-type-divine"], function(values) {
      setAttrs({"repeating_abilities_ability-type":values.repeating_abilities_ability-type-divine});
    });
  });
  on("change:repeating_abilities:ability-type-profane", function() {
    getAttrs(["repeating_abilities_ability-type-profane"], function(values) {
      setAttrs({"repeating_abilities_ability-type":values.repeating_abilities_ability-type-profane});
    });
  });
  on("change:repeating_abilities:ability-type-arcane", function() {
    getAttrs(["repeating_abilities_ability-type-arcane"], function(values) {
      setAttrs({"repeating_abilities_ability-type":values.repeating_abilities_ability-type-arcane});
    });
  });
  on("change:repeating_abilities:ability-type-primeval", function() {
    getAttrs(["repeating_abilities_ability-type-primeval"], function(values) {
      setAttrs({"repeating_abilities_ability-type":values.repeating_abilities_ability-type-primeval});
    });
  });
  on("change:repeating_abilities:ability-type-mundane", function() {
    getAttrs(["repeating_abilities_ability-type-mundane"], function(values) {
      setAttrs({"repeating_abilities_ability-type":values.repeating_abilities_ability-type-mundane});
    });
  });
  on("change:repeating_abilities:ability-subtype-attack", function() {
    getAttrs(["repeating_abilities_ability-subtype-attack"], function(values) {
      setAttrs({"repeating_abilities_ability-subtype":values.repeating_abilities_ability-subtype-attack});
    });
  });
  on("change:repeating_abilities:ability-subtype-augmentation", function() {
    getAttrs(["repeating_abilities_ability-subtype-augmentation"], function(values) {
      setAttrs({"repeating_abilities_ability-subtype":values.repeating_abilities_ability-subtype-augmentation});
    });
  });
  on("change:repeating_abilities:ability-subtype-cataclysm", function() {
    getAttrs(["repeating_abilities_ability-subtype-cataclysm"], function(values) {
      setAttrs({"repeating_abilities_ability-subtype":values.repeating_abilities_ability-subtype-cataclysm});
    });
  });
  on("change:repeating_abilities:ability-subtype-communication", function() {
    getAttrs(["repeating_abilities_ability-subtype-communication"], function(values) {
      setAttrs({"repeating_abilities_ability-subtype":values.repeating_abilities_ability-subtype-communication});
    });
  });
  on("change:repeating_abilities:ability-subtype-creation", function() {
    getAttrs(["repeating_abilities_ability-subtype-creation"], function(values) {
      setAttrs({"repeating_abilities_ability-subtype":values.repeating_abilities_ability-subtype-creation});
    });
  });
  on("change:repeating_abilities:ability-subtype-divination", function() {
    getAttrs(["repeating_abilities_ability-subtype-divination"], function(values) {
      setAttrs({"repeating_abilities_ability-subtype":values.repeating_abilities_ability-subtype-divination});
    });
  });
  on("change:repeating_abilities:ability-subtype-druidism", function() {
    getAttrs(["repeating_abilities_ability-subtype-druidism"], function(values) {
      setAttrs({"repeating_abilities_ability-subtype":values.repeating_abilities_ability-subtype-druidism});
    });
  });
  on("change:repeating_abilities:ability-subtype-illusion", function() {
    getAttrs(["repeating_abilities_ability-subtype-illusion"], function(values) {
      setAttrs({"repeating_abilities_ability-subtype":values.repeating_abilities_ability-subtype-illusion});
    });
  });
  on("change:repeating_abilities:ability-subtype-magisprudence", function() {
    getAttrs(["repeating_abilities_ability-subtype-magisprudence"], function(values) {
      setAttrs({"repeating_abilities_ability-subtype":values.repeating_abilities_ability-subtype-magisprudence});
    });
  });
  on("change:repeating_abilities:ability-subtype-maneuvers", function() {
    getAttrs(["repeating_abilities_ability-subtype-maneuvers"], function(values) {
      setAttrs({"repeating_abilities_ability-subtype":values.repeating_abilities_ability-subtype-maneuvers});
    });
  });
  on("change:repeating_abilities:ability-subtype-psionics", function() {
    getAttrs(["repeating_abilities_ability-subtype-psionics"], function(values) {
      setAttrs({"repeating_abilities_ability-subtype":values.repeating_abilities_ability-subtype-psionics});
    });
  });
  on("change:repeating_abilities:ability-subtype-rejuvenation", function() {
    getAttrs(["repeating_abilities_ability-subtype-rejuvenation"], function(values) {
      setAttrs({"repeating_abilities_ability-subtype":values.repeating_abilities_ability-subtype-rejuvenation});
    });
  });
  on("change:repeating_abilities:ability-subtype-scourge", function() {
    getAttrs(["repeating_abilities_ability-subtype-scourge"], function(values) {
      setAttrs({"repeating_abilities_ability-subtype":values.repeating_abilities_ability-subtype-scourge});
    });
  });

  <!--/Repeating_abilities script-->

  on("clicked:repeating_abilities:edit", function(eventInfo) {
    rowID = eventInfo.sourceAttribute.split('_')[2]
    varName = "repeating_abilities_" + rowID + "_editing"
    getAttrs([varName], function(values) {
      if(values[varName] === "true") setAttrs({"repeating_abilities_editing":"false"});
      else setAttrs({"repeating_abilities_editing":"true"});
    }); 
  });

</script>


<!--
  on("clicked:repeating_abilities:edit", function(eventInfo) {
    rowID = eventInfo.sourceAttribute.split('_')[2]
    getAttrs(["repeating_abilities_abilityType","repeating_abilities_abilitySource","repeating_abilities_abilitySubType"], function(values) {
        $20('.edit.' + values.repeating_abilities_abilityType.toLowerCase()).toggleClass("hidden");
        $20('.edit.' + values.repeating_abilities_abilitySource.toLowerCase()).toggleClass("hidden");
        $20('.edit.' + values.repeating_abilities_abilitySubType.toLowerCase()).toggleClass("hidden");
        $20('.edit.abilitySource').toggleClass("hidden");
    });
});
-->


























